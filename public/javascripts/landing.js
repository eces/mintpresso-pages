// Generated by CoffeeScript 1.6.3
/*
  Author: Jinhyuk Lee
*/


(function() {
  jQuery(function() {
    var $features, $toc, landingViewModel;
    $('#myCarousel').carousel();
    $toc = $('#toc');
    if ($toc.length) {
      $toc.affix({
        offset: {
          top: 79
        }
      });
    }
    $features = $('#features');
    if ($features.length) {
      $('body').scrollspy({
        target: '#toc'
      });
    }
    hljs.tabReplace = '  ';
    $('pre code, code').each(function(i, e) {
      return hljs.highlightBlock(e);
    });
    landingViewModel = function() {
      var self;
      self = this;
      self.username = '';
      self.email = '';
      self.password = '';
      self.signupButton = ko.observable(_('signup.button'));
      self.signup = function(elem) {
        _.Users.signup().ajax({
          data: {
            username: self.username,
            email: self.email,
            password: self.password
          },
          success: function(d, s, x) {
            if (x.status === 201) {
              self.signupButton(_('signup.button.done'));
              Messenger().post({
                message: _('signup.done.redirect'),
                type: 'success'
              });
              return setTimeout(function() {
                return location.href = _.Application.signin().url;
              }, 1000);
            } else {
              return Messenger().post({
                message: _(d),
                type: 'error'
              });
            }
          },
          error: function(x, s, r) {
            return Messenger().post({
              message: _(r),
              type: 'error',
              showCloseButton: true
            });
          }
        });
        return false;
      };
      return true;
    };
    ko.applyBindings(new landingViewModel());
    return true;
  });

}).call(this);
